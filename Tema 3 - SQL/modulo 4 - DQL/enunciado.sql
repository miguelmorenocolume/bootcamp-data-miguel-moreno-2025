/*
===================================================
SAKILA DATABASE - EJERCICIOS NIVEL INTERMEDIO
===================================================

Este archivo contiene ejercicios de SQL intermedio que requieren 
conocimientos más avanzados sobre joins, subconsultas y funciones.
*/

-- SECCIÓN 1: JOINS AVANZADOS
-- --------------------------

-- Ejercicio 1.1: Lista de clientes con sus direcciones completas (incluyendo ciudad y país

-- Ejercicio 1.2: Encuentra qué empleados trabajan en cada tienda, incluyendo la ciudad de la tienda

-- Ejercicio 1.3: Utiliza LEFT JOIN para encontrar actores que no aparecen en ninguna película

-- SECCIÓN 2: SUBCONSULTAS
-- -----------------------

-- Ejercicio 2.1: Encuentra películas que se alquilan por encima del precio promedio de alquiler

-- Ejercicio 2.2: Lista de clientes que nunca han alquilado una película

-- Ejercicio 2.3: Encuentra películas que han sido alquiladas más que la media

-- SECCIÓN 3: FUNCIONES Y MANIPULACIÓN DE TEXTO Y FECHAS
-- ----------------------------------------------------

-- Ejercicio 3.1: Calcula la duración promedio de alquiler por cliente (en días)

-- Ejercicio 3.2: Lista de películas con título en mayúsculas y longitud del título

-- Ejercicio 3.3: Agrupa los alquileres por mes y año, mostrando el total por período

-- SECCIÓN 4: HAVING Y GROUP BY AVANZADO
-- ------------------------------------

-- Ejercicio 4.1: Categorías que tienen más de 60 películas, ordenadas por cantidad descendente

-- Ejercicio 4.2: Clientes que han gastado más de $150 en la categoría "Action"

-- SECCIÓN 5: VISTAS Y USO DE TABLAS TEMPORALES
-- -------------------------------------------

-- Ejercicio 5.1: Crea una vista que muestre el top 5 de actores que aparecen en más películas

-- Consulta la vista

-- Ejercicio 5.2: Crea una tabla temporal con las películas nunca alquiladas

-- SECCIÓN 6: CONSULTAS CON UNION, INTERSECT, EXCEPT
-- -----------------------------------------------

-- Ejercicio 6.1: Lista de clientes y personal que viven en el mismo país

-- Ejercicio 6.2: Encuentra ciudades donde hay clientes pero no hay tiendas

-- SECCIÓN 7: PROCEDIMIENTOS ALMACENADOS BÁSICOS
-- -------------------------------------------

-- Ejercicio 7.1: Crea un procedimiento almacenado para buscar películas por actor

-- Llamada al procedimiento

-- Ejercicio 7.2: Crea un procedimiento para actualizar el inventario de una película

-- SECCIÓN 8: RETO FINAL NIVEL INTERMEDIO
-- -------------------------------------

-- Ejercicio 8.1: Análisis de ingresos
-- Calcula el ingreso total por mes, tienda y categoría de película

-- Ejercicio 8.2: Crea una función que calcule el ingreso total generado por un cliente